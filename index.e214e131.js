var t={};Object.defineProperty(t,"BOARD_SIZE",{get:function(){return e},set:void 0,enumerable:!0,configurable:!0});const e=4;function s(t){return t.filter(t=>0!==t)}const r=Array.from({length:4},()=>Array(e).fill(0));class a{static Status={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=r){this.state=t.map(t=>[...t]),this.status=a.Status.idle,this.initialState=t,this.score=0}transposeArray(){return this.state[0].map((t,e)=>this.state.map(t=>t[e]))}mirrorArray(){return this.state.map(t=>t.reverse())}slide(t){let r=s(t);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,r.splice(t+1,1),this.score+=r[t]);for(;r.length<e;)r.push(0);return r}slideLeft(){let t=[],e=[];return(t=this.state.map(t=>(e.push(Array.from(t)),this.slide(t)))).join(",")!==e.join(",")&&this.getRandomCell(t),t}move(t){if(this.status===a.Status.playing){switch(t){case"ArrowRight":this.moveRight();break;case"ArrowLeft":this.moveLeft();break;case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;default:return}this.checkGameStatus()}}moveLeft(){return this.state=this.slideLeft(),this.state}moveRight(){return this.state=this.mirrorArray(),this.state=this.slideLeft(),this.state=this.mirrorArray(),this.state}moveUp(){return this.state=this.transposeArray(),this.state=this.slideLeft(),this.state=this.transposeArray(),this.state}moveDown(){return this.state=this.transposeArray(),this.state=this.mirrorArray(),this.state=this.slideLeft(),this.state=this.mirrorArray(),this.state=this.transposeArray(),this.state}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=a.Status.playing,this.getRandomCell(this.state,2)}restart(){this.status=a.Status.idle,this.state=this.initialState.map(t=>[...t]),this.score=0}checkGameStatus(){this.state.forEach(t=>{t.includes(2048)&&(this.status=a.Status.win)}),this.checkEmptyCells()||this.checkIsMergeable()||(this.status=a.Status.lose)}checkEmptyCells(){return this.state.some(t=>t.some(t=>0===t))}checkIsMergeable(){let t=this.state.map(t=>{let r=s(t);for(;r.length<e;)r.push(0);return r});for(let s=0;s<e-1;s++)for(let r=0;r<e-1;r++){let e=t[s][r];if(0!==e&&(e===t[s+1][r]||e===t[s][r+1]))return!0}return!1}getRandomCell(t,s=1){let r=[];for(let a=0;a<s;a++){for(let s=0;s<e;s++)for(let a=0;a<e;a++)0===t[s][a]&&r.push([s,a]);if(r.length>0){let[e,s]=r[Math.floor(Math.random()*r.length)];t[e][s]=.9>Math.random()?2:4}}}}const i=new(t=a),n=document.querySelector(".start"),l=document.querySelector(".game-field"),o=document.querySelector(".game-score"),h=document.querySelector(".message-start"),c=document.querySelector(".message-lose"),d=document.querySelector(".message-win");function u(){(function(){l.innerHTML="";let t=i.getState();for(let e=0;e<4;e++){let s=document.createElement("tr");for(let r=0;r<4;r++){let a=document.createElement("td"),i=t[e][r];a.textContent=0!==i?i:"",a.classList.add("field-cell"),0!==i&&a.classList.add(`field-cell--${i}`),s.appendChild(a)}l.appendChild(s)}})(),o.textContent=i.getScore(),i.getStatus()===t.Status.win?d.classList.remove("hidden"):i.getStatus()===t.Status.lose&&c.classList.remove("hidden")}n.addEventListener("click",()=>{n.classList.contains("start")?(i.start(),n.classList.remove("start"),n.classList.add("restart"),n.textContent="Restart",h.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")):n.classList.contains("restart")&&(i.restart(),n.classList.remove("restart"),n.classList.add("start"),n.textContent="Start",h.classList.add("hidden"),c.classList.add("hidden"),d.classList.add("hidden")),u()}),document.addEventListener("keyup",t=>{i.move(t.key),u()}),u();
//# sourceMappingURL=index.e214e131.js.map
